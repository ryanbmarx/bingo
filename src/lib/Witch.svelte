<script lang="ts">
	import { getRandomInt } from '../utils/random';

	let fly = $state(false);

	function initWitch(node: SVGElement) {
		const randomWaitTime = getRandomInt(60, 500) * 1000;
		setTimeout(() => {
			fly = true;
			initWitch(node);
		}, randomWaitTime);
	}

	function stopFlying() {
		fly = false;
	}
</script>

<svg
	onanimationend={stopFlying}
	use:initWitch
	class:fly
	id="flying-witch"
	viewBox="0 0 652 528"
	version="1.1"
	xmlns="http://www.w3.org/2000/svg"
	xmlns:xlink="http://www.w3.org/1999/xlink"
	xml:space="preserve"
>
	<rect x="0" y="0" width="651.604" height="527.086" style="fill:none;" />
	<clipPath id="_clip1-flying-witch">
		<rect x="0" y="0" width="651.604" height="527.086" />
	</clipPath>
	<g clip-path="url(#_clip1-flying-witch)">
		<path
			d="M445.284,248.276c-15.579,-7.908 -32.491,-17.367 -42.296,-25.583c-10.554,22.554 5.826,29.708 22.363,36.779l19.933,-11.196Zm-372.112,187.617c-16.546,0.925 -41.367,-0 -72.625,-2.759c37.692,-11.945 93.762,-30.329 125.929,-38.604c29.1,-7.483 47.662,-10.416 64.546,-3.437l161.408,-90.663c-2.179,-0.754 -4.912,-1.025 -8.271,-1.025c-9.016,0 -20.15,0 -28.108,-4.775c-7.954,-4.775 -12.196,-15.379 -12.196,-22.804c0,-7.421 6.359,-24.925 12.725,-36.058c-19.046,15.796 -41.204,29.646 -54.091,35.529c-14.063,6.421 -14.313,3.183 -7.421,-2.121c6.891,-5.304 29.7,-24.396 36.058,-31.817c-14.846,6.892 -37.121,20.68 -45.071,24.921c-7.958,4.246 -10.337,0.892 -5.029,-2.816c5.296,-3.717 28.354,-19.984 33.129,-25.817c-14.317,5.833 -49.316,21.742 -63.104,27.575c-13.783,5.833 -11.296,-0.233 -3.337,-4.475c7.949,-4.242 44.17,-23.633 53.716,-32.117c-22.129,4.971 -48.679,8.35 -60.875,9.413c-12.2,1.062 -14.558,-2.221 -0.741,-6.171c11.399,-3.254 66.92,-23.921 77,-28.163c10.074,-4.245 45.166,-21.7 54.087,-29.166c9.888,-8.275 19.092,-18.563 25.45,-27.579c-9.546,7.424 -31.283,16.97 -44.542,20.15c-13.258,3.183 -32.112,6.275 -45.37,6.275c13.258,-3.18 39.537,-8.926 48.025,-13.696c8.479,-4.775 13.783,-8.488 18.558,-12.196c-10.609,3.708 -32.883,13.254 -46.134,15.908c13.251,-5.833 28.105,-15.379 33.401,-20.15c-15.371,5.3 -38.176,14.313 -52.496,15.904c-14.317,1.592 -24.8,2.88 -42.067,-0.083c18.558,-1.592 52.675,-8.929 73.883,-19.008c-18.025,1.591 -36.058,6.366 -50.375,4.775c9.546,-2.65 27.046,-6.363 37.121,-10.609c-15.912,-2.116 -30.225,0.004 -41.896,-2.116c14.321,-0 38.713,-5.304 51.442,-10.604c-13.788,-2.655 -22.804,-3.713 -35.004,-0c14.854,-7.425 36.067,-12.73 54.096,-11.667c-8.488,-2.654 -22.275,-6.367 -32.88,-5.833c18.026,-4.775 37.117,-10.609 53.559,-9.546c-6.892,-2.654 -16.967,-7.425 -29.167,-5.834c12.625,-1.804 40.192,-6.675 56.646,-9.066c-16.275,-3.754 -33.804,-8.15 -44.513,-12.209c15.38,2.654 37.196,3.7 50.455,3.163c3.991,-3.992 6.829,-5.992 10.062,-10.525c3.325,-4.646 12.567,-18.492 15.379,-28.633c2.65,-9.546 -8.962,-12.955 -22.8,-12.725c-9.387,0.15 -43.816,-2.084 -54.95,-8.446c18.317,3.662 45.921,-3.925 57.071,-4.817c20.375,-1.621 35.058,-0.45 43.608,6.129c7.521,5.784 11.646,13.471 13.234,29.379c1.117,11.109 -0.496,25.313 -2.492,40.963c12.192,12.729 24.971,17.817 41.625,25.975c-9.883,-1.038 -32.491,-8.292 -40.354,-11.571c1.179,3.425 1.008,6.542 -1,9.354c-2.654,3.709 -0,4.242 3.708,7.421c3.713,3.183 11.363,8.358 12.429,11.008c1.059,2.655 2.296,6.692 1.234,9.871c-1.063,3.179 -4.658,2.225 -6.767,-0.196c-1.554,-1.787 -5.833,-3.712 -7.954,-4.241c-2.121,-0.529 -3.713,0.529 -3.713,3.179c-6.362,-0 -17.183,-4.004 -25.354,-13.667c2.167,15.479 17.617,19.888 23.979,21.475c2.121,5.833 5.084,8.504 9.321,11.159c4.25,2.649 -0.087,7.283 -5.491,7.158c-7.329,-0.167 -15.713,-3.321 -19.421,-4.913c-3.717,-1.591 -3.196,0.871 -3.725,4.58c-0.529,3.712 1.358,11.479 6.375,15.57c7.446,6.075 24.387,15.375 36.058,20.15c11.667,4.775 46.671,12.73 58.334,14.321c2.129,-6.896 5.133,-10.579 11.462,-11.412c5.258,-0.692 12.933,-0.788 15.05,3.987c0.163,0.367 0.308,0.754 0.45,1.134l110.979,-62.334c2.175,-1.221 4.925,-0.446 6.142,1.725c1.221,2.171 0.446,4.921 -1.721,6.142l-113.579,63.792c0.037,2.295 -0.217,4.67 -0.838,7.037c-1.512,5.733 -6.462,10.654 -12.825,10.654c-6.362,0 -10.345,-1.104 -14.587,-1.633c-5.308,6.362 -7.588,14.283 -13.55,21.783c-5.158,6.492 -11.908,14.275 -14.021,19.575c-2.438,-1.1 -12.733,-5.646 -25.388,-11.8l-19.491,10.946c2.475,1.242 4.817,2.558 6.9,4.021c5.521,3.883 11.629,16.654 5.266,25.667c-6.362,9.016 -11.312,23.666 -13.437,29.5c-2.117,5.837 -2.096,18.004 1.067,29.695c3.32,12.28 7.466,19.692 10.645,23.938c-10.07,-2.654 -19.133,-7.492 -24.962,-11.208c-5.833,-3.713 -4.775,-4.242 -9.013,5.304c-4.245,9.546 -7.82,17.896 -18.016,33.079c-12.088,18.017 -21.959,30.354 -36.275,40.962c-12.575,9.33 -11.188,3.55 -6.417,-4.933c4.775,-8.487 15.629,-30.925 18.813,-43.654c3.183,-12.725 1.591,-14.317 -7.959,-6.892c-9.545,7.421 -14.554,13.034 -24.92,22.804c-7.817,7.359 -9.388,4.359 -5.671,-3.6c3.712,-7.954 5.671,-16.025 6.729,-23.979c1.062,-7.954 -4.238,-9.016 -10.604,-0.529c-6.363,8.483 -10.538,15.596 -20.067,25.742c-11.354,12.096 -18.117,19.862 -32.967,28.879c-14.846,9.017 -30.225,20.15 -44.012,28.108c-13.784,7.95 -12.842,1.746 -1.983,-6.891c10.245,-8.155 26.379,-22.805 36.987,-32.884c10.604,-10.075 15.908,-19.091 24.392,-28.633c-22.146,10.929 -39.871,16.312 -54.721,20.554c-14.846,4.242 -29.067,4.896 -11.567,-3.058c17.496,-7.954 72.463,-41.629 87.496,-52.5c19.079,-13.788 32.883,-23.863 39.246,-31.288c6.362,-7.425 10.3,-15.016 8.708,-22.971c-0.146,-0.741 -0.333,-1.416 -0.529,-2.054l-162.179,91.088c0.121,20.554 -10.075,30.104 -19.488,41.229c-26.545,28.846 -24.566,27.154 -34.008,34.925c-11.808,9.729 -39.525,35.85 -60.663,53.312c11.021,-14.708 15.621,-24.816 26.655,-42.279c-14.713,10.109 -34.013,17.463 -53.313,28.496c9.188,-11.95 19.3,-23.9 33.088,-40.446c-12.871,8.271 -34.009,18.384 -52.4,23.9c15.629,-11.95 29.42,-27.579 38.612,-38.608c-11.946,3.679 -31.254,3.679 -50.558,4.6c14.716,-6.438 32.179,-14.713 48.725,-27.579Z"
		/>
	</g>
</svg>

<style lang="scss">
	svg {
		fill-rule: evenodd;
		clip-rule: evenodd;
		stroke-linejoin: round;
		stroke-miterlimit: 2;

		position: fixed;
		width: 10rem;
		bottom: 35vh;
		transform: translate(-100%, 0);

		&.fly {
			animation: fly 3s 1;
			animation-timing-function: ease-in;
			animation-fill-mode: forwards;
		}

		path {
			fill: #0005;
			fill-rule: nonzero;
		}
	}

	@keyframes fly {
		from {
			transform: rotate(10deg) translate(-100%, 200%);
			left: 0;
		}

		80% {
			transform: rotate(5deg) translate(-100%, 200%);
		}

		to {
			left: 100%;
			transform: rotate(-10deg) translate(100%, -300%);
		}
	}
</style>
