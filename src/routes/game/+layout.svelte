<script lang="ts">
	// TODO: Wait a day then download these:
	// https://www.vecteezy.com/vector-art/3220038-halloween-illustration-set-collection-for-sticker-greeting-cards
	// https://www.vecteezy.com/vector-art/9455114-set-of-cute-halloween-elements-isolated-on-white-background-vector-graphics

	// https://www.vecteezy.com/vector-art/3057106-halloween-background-haunted-zombie-shadow-vector-illustration

	// STYLES
	import '$lib/../global.scss';

	// UTILS
	import { getRandomInt } from '$lib/../utils/random';
	import type { IconImage } from '$lib/../types.d';
	import { page } from '$app/stores';

	// COMPONENTS
	import Controls from '$lib/Controls.svelte';
	import Image from '$lib/Image.svelte';
	import House from '$lib/House.svelte';
	import Witch from '$lib/Witch.svelte';

	const images: IconImage[] = $page.data.images || [];

	let imagesToUse: typeof images = $state([...images]);
	let usedImages: typeof images = $state([]);

	let pageTitle = $page.data.pageTitle || 'Bingo';
	let isDisabled = $derived(imagesToUse.length === 0);

	function handleNext() {
		if (isDisabled) return;

		const randomIndex = getRandomInt(0, imagesToUse.length - 1);
		const randomImage = imagesToUse[randomIndex];

		imagesToUse.splice(randomIndex, 1);
		usedImages = [randomImage, ...usedImages];
	}

	function handleReset() {
		imagesToUse = [...images];
		usedImages = [];
	}

	function handleKeyPress(e: KeyboardEvent) {
		e.preventDefault();
		const { code } = e;
		if (code === 'Space') handleNext();
		if (code === 'KeyR') handleReset();
	}
</script>

<ul>
	{#each usedImages as { id, Component }, idx (id)}
		<li>
			<Image isFeatured={idx === 0} {id} ImageComponent={Component} />
		</li>
	{/each}
</ul>

<Witch />
<House />
<div class="foreground">
	<svg
		width="100%"
		height="100%"
		viewBox="0 0 3308 608"
		version="1.1"
		xmlns="http://www.w3.org/2000/svg"
		xmlns:xlink="http://www.w3.org/1999/xlink"
		xml:space="preserve"
		xmlns:serif="http://www.serif.com/"
		style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"
	>
		<g id="background-foreground" transform="matrix(1,0,0,1,0,-1200.47)">
			<rect x="0" y="1200.47" width="3307.47" height="607.604" style="fill:none;" />
			<clipPath id="_clip1background-foreground">
				<rect x="0" y="1200.47" width="3307.47" height="607.604" />
			</clipPath>
			<g clip-path="url(#_clip1background-foreground)">
				<g transform="matrix(4.16667,0,0,4.16667,0,-674.796)">
					<path
						d="M719.847,525.553C719.681,525.528 719.544,525.509 719.493,525.509C719.411,525.509 719.556,525.524 719.847,525.553ZM788.403,496.49L793.327,491.538L793.792,491.454L793.792,487.078L791.983,489.29L787.062,493.339L776.673,491.634L775.614,487.734L777.837,483.903L783.706,485.465L789.972,482.09L793.552,482.541L789.747,480.968L783.706,483.891C783.706,483.891 780.503,482.602 778.979,481.935L779.974,480.222L778.827,479.167L786.169,474.894L790.419,475.57L785.942,473.093L778.095,478.492L772.968,473.768L776.995,469.719L782.142,470.394L785.942,466.345L782.142,468.821L776.101,467.471L771.659,471.722L766.925,464.321L779.351,450.175L766.978,461.121L762.005,457.12L766.136,461.87L763.786,463.946L765.556,466.997L762.675,468.369L758.647,466.121L754.843,467.471L758.647,467.695L763.122,469.943L766.288,468.259L772.503,478.969L772.788,483.407L764.69,484.115L762.228,479.842L761.03,479.453L757.751,472.418L759.06,478.81L753.95,477.143L750.146,479.391L747.462,474.444L749.474,481.415L753.95,479.618L760.663,482.09L762.03,484.203L753.95,488.164L762.849,485.461L764.017,487.266L772.938,485.769L773.474,494.128L769.388,491.091L764.69,494.239L760.214,491.766L765.583,496.039L769.388,493.563L773.612,496.284L773.749,498.375L766.78,505.818L761.286,501.214L759.597,502.428L757.032,500.873L754.786,493.038L749.044,491.359L747.013,485.241L747.62,490.945L747.163,490.813L739.128,480.905L729.503,483.004L738.177,482.894L745.667,493.395L752.394,496.115L755.624,505.281L753.144,507.065L742.091,510.864L738.769,509.196L741.509,506.184L739.472,501.508L740.927,497.997L731.909,491.858L737.437,498.291L735.985,502.967L738.021,506.184L736.161,507.884L735.694,507.648L732.782,506.184L724.64,506.771L719.112,512.327L711.552,506.771L718.821,514.668L725.806,510.28L732.2,509.111L728.22,514.711C728.22,514.711 722.179,515.835 722.849,515.835C723.521,515.835 729.116,515.611 729.116,515.611L733.722,510.574L738.892,515.544L747.683,512.934L742.538,523.486L750.247,512.17L751.688,511.744L758.378,511.157L760.995,508.818L761.731,512.515L757.044,520.489L754.396,518.762L748.804,520.559L753.501,520.335L756.089,522.114L755.694,522.788L756.55,524.435L753.226,528.121L745.222,528.822L743.243,532.68L740.526,529.559L734.931,529.782L732.917,526.632C732.917,526.632 721.995,525.763 719.847,525.553C721.89,525.876 731.802,527.982 731.802,527.982L734.036,531.807L739.405,531.583L742.124,534.861L741.612,535.853L730.505,541.82L730.7,551.627L732.245,543.125L743.827,537.811L747.741,531.748L759.454,530.006L762.542,535.933L762.841,539.621L760.214,542.155L754.173,539.007L749.253,544.405L744.327,542.381L749.923,545.755L744.554,551.155L749.923,546.88L751.067,544.864L754.843,541.93L760.214,544.629L762.899,543.056L763.124,543.129L763.349,545.899L760.858,550.593L760.776,551.004C759.505,550.369 758.423,549.805 758.423,549.805L752.382,554.529L743.433,553.179L737.614,555.878L733.589,553.403L738.288,557.904L743.212,555.203L739.854,561.501L745.446,555.427L749.698,556.778L751.937,559.028L752.608,557.228L756.187,555.203L758.423,553.628L760.062,554.606L758.991,559.983L757.465,561.871C749.161,563.275 741.453,564.792 731.149,566.713C722.223,568.376 707.745,571.153 691.253,573.682L689.909,566.983L688.589,567.248L688.173,565.18L684.657,565.892L681.077,548.03L671.433,549.983L667.847,550.709L658.661,552.571L662.239,570.432L659.036,571.081L659.452,573.15L658.288,573.388L659.166,577.771C641.966,579.43 624.912,580.054 611.263,578.38C600.956,577.116 592.021,575.989 583.664,574.886L584.03,570.445L582.69,570.333L582.862,568.228L579.284,567.931L580.78,549.77L570.976,548.953L567.329,548.65L557.991,547.873L556.497,566.034L553.239,565.763L553.067,567.868L551.884,567.77L551.668,570.396C542.736,569.066 533.237,567.594 522.185,565.846L516.335,564.961C509.195,564.044 500.021,563.732 489.375,564.097L483.49,564.36C468.221,565.196 450.396,567.323 431.458,570.939C422.15,572.716 402.336,573.136 389.693,571.482L383.765,570.405L383.588,570.363C374.438,567.999 365.812,569.838 357.252,572.215L350.281,574.329C340.21,578.011 338.322,582.565 326.4,576.572C320.937,573.825 315.778,571.85 310.788,570.605L309.588,565.272L308.275,565.569L307.814,563.507L304.311,564.303L300.322,546.528L290.726,548.704L287.157,549.515L278.017,551.589L282.008,569.364L278.819,570.087L279.283,572.149L278.125,572.409L278.258,573.004L278.169,573.036C277.174,573.426 276.226,573.815 275.32,574.201L271.064,576.11C260.544,581.009 255.12,584.463 237.419,579.272C233.228,578.042 228.716,577.145 224.035,576.53L222.432,572.785L216.223,568.787L216.577,567.508L220.75,567.722L224.484,566.328L226.566,562.669L228.883,563.551L231.404,561.388L233.338,563.199L237.198,563.592L240.804,560.412L247.083,561.211L245.444,560.078L239.734,558.365L236.308,561.566L232.269,559.059L233.97,556.326L237.915,555.115L241.958,555.529L237.664,553.638L232.388,555.523L229.483,558.613L224.182,560.329L221.092,565.499L217.443,564.377L218.397,560.929L212.308,554.785L213.363,553.693L219.352,555.321L223.101,555.059L226.476,556.854L222.905,553.908L220.076,554.267L214.898,552.103L220.679,549.394L225.223,550.875L227.654,553.386L232.126,550.817L234.118,547.388L239.88,550.125L233.775,546.058L230.566,548.884L226.992,549.87L224.182,548.178L225.732,544.035L229.18,545.195L232.18,541.629L229.266,543.59L224.063,542.737L222.798,547.344L221.559,546.597L214.733,549.394L210.855,550.069L209.807,551.521L208.311,549.097L208.115,549.397L205.975,546.55L207.237,545.7L209.583,546.745L213.259,545.026L217.146,545.579L213.615,543.931L209.204,545.579L206.265,543.675L207.585,540.708L214.241,541.253L208.121,539.505L208.983,537.568L212.185,534.578L217.495,539.164L222.063,537.373L225.837,539.37L229.252,535.042L225.343,537.547L221.5,536.187L217.271,537.852C217.271,537.852 214.643,533.948 213.752,533.114L214.616,532.308L213.008,528.825L215.533,527.675L221.427,529.405L224.85,526.206L227.137,526.06L231.407,528.647L233.394,532.883L240.675,534.27L233.566,531.771L232.921,527.996L229.612,525.901L233.602,525.645L234.587,519.78L232.488,524.405L224.848,524.447L226.91,520.286L223.47,524.453L219.93,526.995L211.187,524.882L209.83,521.945L211.177,519.338L216.192,520.97L220.918,519.03L223.912,519.659L220.595,518.194L215.995,519.822C215.995,519.822 213.208,518.612 211.871,517.996L212.474,516.829L211.4,515.962L216.896,513.461L220.471,514.309L216.488,512.129L210.716,515.409L205.915,511.533L208.716,508.916L213.028,509.841L215.647,507.203L212.831,508.691L207.701,507.199L204.585,509.931L199.776,504.136L208.216,494.855L199.42,501.806L194.835,498.471L198.82,502.28L197.15,503.6L198.983,505.973L196.79,506.735L193.201,504.753L190.243,505.421L193.398,505.905L197.352,507.919L199.741,506.954L206.18,515.291L206.967,518.552L200.405,518.39L197.851,515.069L196.82,514.684L193.25,509.276L195.122,514.049L190.716,512.405L187.871,513.729L185.051,509.892L187.571,515.148L191.025,514.213L196.844,516.577L198.232,518.233L192.089,520.447L199.061,519.22L200.247,520.635L207.386,520.289L208.869,526.432L205.132,523.874L201.667,525.778L197.684,523.599L202.626,527.165L205.442,525.678L209.251,528.017L209.623,529.555L204.83,534.403L199.742,530.582L198.504,531.327L196.204,529.977L193.384,524.072L188.457,522.367L186.029,517.734L187.239,521.947L186.845,521.811L179.012,513.908L171.368,514.634L178.477,515.28L185.938,523.57L191.803,526.118L195.599,533.076L193.782,534.169L185.18,536.018L182.244,534.521L184.117,532.555L181.864,528.972L182.62,526.532L174.45,521.296L179.789,526.452L179.179,529.743L181.253,532.262L179.938,533.346L179.525,533.135L176.953,531.825L170.337,531.569L166.49,535.161L159.586,530.474L166.539,536.843L171.73,534.228L176.84,533.908L174.266,537.66C174.266,537.66 169.445,537.976 169.996,538.033C170.549,538.09 175.113,538.394 175.113,538.394L178.272,535.104L183.133,539.162L190.03,537.994L187.121,545.264L192.041,537.655L193.17,537.463L198.593,537.595L200.452,536.106L201.517,538.867L198.661,544.293L196.27,542.809L191.899,543.654L195.733,543.881L198.08,545.398L197.838,545.857L198.748,547.129L196.476,549.54L189.99,549.383L188.844,552.032L186.225,549.526L181.659,549.222L179.61,546.755C179.61,546.755 170.577,545.212 168.749,544.874C170.507,545.293 178.862,547.646 178.862,547.646L181.175,550.624L185.556,550.908L188.198,553.528L187.903,554.209L179.521,557.633L180.905,564.808L181.114,558.734L189.966,555.823L192.424,551.731L201.825,551.436L205.102,556.022L205.806,558.737L203.966,560.366L198.61,557.562L195.24,561.09L190.945,559.201L195.96,562.13L192.225,565.62L196.1,562.95L196.79,561.576L199.527,559.751L204.272,562.172L206.282,561.248L206.476,561.322L207.005,563.361L205.545,566.577L205.529,566.869C204.408,566.3 203.448,565.796 203.448,565.796L199.075,568.738L191.555,567.005L187.116,568.489L183.499,566.343L187.92,570.022L191.625,568.462L189.654,572.78L193.492,568.815L197.151,570.154L199.27,571.984L199.595,570.726L202.282,569.548L203.924,568.587L205.39,569.437L205.182,573.271L203.342,575.531C190.45,575.855 177.809,577.778 168.113,580.563C159.933,575.863 150.305,571.531 138.149,570.477L133.293,570.238C124.715,570.135 114.944,571.664 103.65,575.706C103.191,575.361 102.752,575.033 102.307,574.7L95.622,569.822C78.525,557.767 73.355,558.183 62.012,565.909C59.834,565.121 57.78,564.378 55.811,563.678L54.395,559.26L55.226,554.717L56.653,553.894L57.753,555.226L59.655,556.935L59.596,558.453L61.816,556.555L65.177,555.416L67.297,560.546L66.805,555.23L69.446,557.507L74.043,553.711L70.507,555.801L67.242,553.52L60.604,554.657L57.773,550.666C57.773,550.666 56.853,551.144 55.782,551.678L55.845,551.334L55.483,547.371L56.451,545.034L56.631,544.971L58.043,546.3L62.58,544.023L64.354,546.501L64.561,548.201L67.054,551.811L64.892,547.252L69.783,544.405L65.756,546.114L63.905,541.556L58.767,544.211L57.678,542.072L58.968,538.959L62.859,533.957L70.517,535.433L71.471,540.549L77.993,545.04L76.578,552.214L79.591,543.936L73.59,538.897L73.525,538.059L76.382,535.293L80.061,535.486L82.743,532.256C82.743,532.256 90.274,530.481 91.794,530.209C90.222,530.385 82.36,531.117 82.36,531.117L80.029,533.777L76.194,533.584L73.384,536.219L73.133,532.962L67.756,532.368L66.517,529.257L67.599,527.866L67.52,527.297L69.847,525.795L73.059,525.987L69.685,524.468L67.33,525.926L66.398,519.197L67.996,516.072L69.136,518.049L73.631,518.544L74.509,518.905L76.57,528.458L76.075,519.549L81.443,521.755L86.505,517.564L88.244,521.816C88.244,521.816 92.079,522.007 92.547,522.007C93.016,522.007 89.131,521.057 89.131,521.057L87.995,516.329L92.115,517.319L95.701,521.022L103.088,514.361L96.183,519.047L93.956,514.356L88.447,513.861L85.989,515.093L85.593,515.293L84.795,513.858L87.158,511.143L87.515,507.195L93.256,501.766L85.167,506.947L85.152,509.91L82.361,513.858L83.39,516.398L80.582,517.807L73.987,514.595L72.779,513.09L77.719,505.355L83.211,503.061L91.514,494.199L97.532,494.295L91.432,492.522L82.924,500.88L82.564,500.993L84.661,496.178L81.452,501.342L76.953,502.756L73.09,509.367L70.845,510.682L70.022,509.657L64.839,513.54L62.163,507.255L62.869,505.491L66.613,503.197L68.543,505.285L73.541,501.68L69.693,503.767L67.339,501.108L63.598,503.67L66.422,496.617L72.205,497.884L73.551,496.361L78.966,498.645L74.491,495.298L76.065,493.516L81.471,491.43L84.066,492.948L87.514,487.064L84.19,491.241L82.197,489.342L78.144,490.745L80.929,485.353L76.581,491.286L75.631,491.615L72.662,495.223L67.22,494.624L68.72,490.878L76.195,481.84L77.909,483.262L81.689,481.364L84.409,481.177L82.151,480.036L78.682,481.933L77.075,480.775L79.204,478.2L78.175,476.446L82.449,472.441L77.806,475.817L72.384,466.572L76.904,478.514L71.433,484.761L69.583,481.17L64.973,482.307L63.044,480.22L64.51,483.638L68.299,483.07L69.92,486.489L64.958,490.474L61.065,485.916L57.22,488.003L60.383,487.435L64.251,491.041L63.141,491.933L63.332,493.379C62.07,493.943 59.461,495.03 59.461,495.03L56.104,492.558L52.99,493.886L55.619,493.508L59,496.358L63.552,495.041L63.98,498.273L62.097,501.565L54.351,503.002L52.103,499.584L50.36,494.266L50.97,499.409L44.696,498.442L44.177,492.745L43.455,499.769L46.671,500.55L43.402,502.619L41.884,506.986L35.383,509.071L41.735,508.315L44.477,503.567L48.666,501.034L50.508,501.482L52.491,505.659L57.791,504.331L59.568,505.99L57.335,509.896L57.835,510.949C56.884,511.822 53.702,516.106 53.702,516.106L50.658,513.635L47.14,514.775L44.581,511.356L46.258,516.861L49.885,514.965L53.174,517.624L58.743,512.864L60.595,516.767L60.798,519.153L55.307,520.474L60.924,520.632L61.236,524.283L58.32,526.171L55.121,523.702L51.784,525.22L55.128,525.03L57.703,527.501L59.907,526.551L60.724,527.703L58.219,530.798L58.136,530.42L56.272,533.094L55.788,531.259L52.773,529.998L47.891,525.883L46.674,526.614L46.837,521.038L42.335,521.416L40.449,518.757L41.986,523.316L45.126,522.366L45.319,527.43L42.565,529.085L39.881,527.493L37.98,523.78L31.895,527.835L37.351,525.304L38.093,529.58L41.103,533.144L43.757,530.48L47.884,529.283L51.931,533.167L47.107,535.093L44.873,534.33L41.165,537.369L44.412,535.661L47.426,536.421L52.779,535.223L53.362,536.637L46.747,543.14L46.63,547.314L43.336,548.195L42.145,541.736L38.23,539.076L36.65,535.09L32.801,532.237L28.773,533.946L32.208,533.946L35.138,535.845L35.823,539.265L31.844,541.732L29.862,537.554L24.718,538.88L22.801,534.514L23.074,540.019L28.447,539.832L30.585,544.01L33.862,544.011L35.926,542.114L37.434,544.963L39.571,544.204L40.329,548.761L43.037,550.852L46.525,551.102L46.482,552.651L40.33,556.613L39.278,558.541C28.8,556.043 18.065,555.4 0,557.003L0,589.959L0.002,596L793.751,596L793.751,557.003C788.999,557.521 784.745,558.013 780.86,558.491L780.47,556.854L773.62,552.159L774.331,550.322L779.458,550.029L784.378,547.555L787.735,542.155L790.419,543.056L793.792,539.876L793.792,534.322L792.21,536.081L785.272,539.231L780.351,546.88L776.067,545.836L777.979,540.892L771.733,533.186L773.276,531.51L780.351,532.933L785.048,532.032L788.853,534.057L785.048,530.457L781.47,531.358L775.513,529.074L783.249,524.475L788.567,525.895L791.046,529.052L793.792,527.149L793.792,523.096L790.968,524.244L787.847,522.281L790.642,516.285L793.792,517.165L793.792,515.064L788.853,514.711L786.308,521.319L784.929,520.449L775.88,525.322L770.933,526.812L769.327,528.987L767.989,525.82L767.679,526.269L765.628,522.601L767.374,521.233L770.06,522.359L774.979,519.436L779.679,519.659L775.651,517.859L769.835,520.785L766.597,518.546L768.858,514.22L776.995,514.036L769.778,512.467L771.259,509.643L775.856,505.018L781.47,510.662L787.511,507.512L791.761,509.76L793.792,507.185L793.792,505.586L791.538,507.288L787.062,505.939L781.47,508.862C781.47,508.862 779.038,503.787 778.11,502.751L779.351,501.504L778.095,496.879L781.47,494.913L788.403,496.49ZM168.749,544.874C168.598,544.838 168.489,544.816 168.445,544.811C168.378,544.804 168.496,544.828 168.749,544.874ZM92.054,530.171C92.018,530.171 91.92,530.187 91.794,530.209C92.009,530.185 92.11,530.171 92.054,530.171Z"
						style="fill:#220929;fill-rule:nonzero;"
					/>
				</g>
				<g transform="matrix(1.86168,0,0,1.86168,-674.572,1261.02)">
					<path
						d="M687.083,235.174L687.083,231.19L680.39,231.19L680.39,197.066L667.771,184.446L649.923,184.446L637.304,197.066L637.304,231.19L629.374,231.19L629.374,235.174L625.545,235.174L625.545,241.867L690.812,241.867L690.812,235.174L687.083,235.174Z"
						style="fill:#220929;fill-rule:nonzero;"
					/>
				</g>
				<g transform="matrix(1.38482,0.0927689,-0.0668402,0.997764,-1539.24,-463.788)">
					<g transform="matrix(0.99922,0.0394973,-0.0652282,1.65017,126.588,-1333.69)">
						<path
							d="M2375.77,1901.3L2375.77,1961.31C2375.77,1970.71 2366.69,1978.34 2355.5,1978.34L2314.95,1978.34C2303.76,1978.34 2294.68,1970.71 2294.68,1961.31L2294.68,1901.3C2294.68,1891.9 2303.76,1884.27 2314.95,1884.27L2355.5,1884.27C2366.69,1884.27 2375.77,1891.9 2375.77,1901.3Z"
							style="fill:#220929;"
						/>
					</g>
					<g transform="matrix(1.3194,0,0,0.138638,-746.018,1694.19)">
						<rect x="2294.68" y="1884.27" width="81.093" height="94.064" style="fill:#220929;" />
					</g>
					<g transform="matrix(1.55508,-0.0245526,0.000919427,0.0582335,-1298.16,1910.6)">
						<rect x="2294.68" y="1884.27" width="81.093" height="94.064" style="fill:#220929;" />
					</g>
				</g>
				<g transform="matrix(0.998209,-0.0598278,0.0598278,0.998209,-554.077,-132.5)">
					<rect x="2294.68" y="1884.27" width="81.093" height="94.064" style="fill:#220929;" />
				</g>
				<g transform="matrix(1.31289,-0.130895,0.013754,0.137954,-1195.43,1741.69)">
					<rect x="2294.68" y="1884.27" width="81.093" height="94.064" style="fill:#220929;" />
				</g>
				<g transform="matrix(1.54498,-0.178708,0.0066921,0.057855,-1723.38,2011.8)">
					<rect x="2294.68" y="1884.27" width="81.093" height="94.064" style="fill:#220929;" />
				</g>
			</g>
		</g>
	</svg>
</div>

<Controls {handleNext} {handleReset} {isDisabled} />

<svelte:window onkeypress={handleKeyPress} />
<svelte:head>
	<title>{pageTitle}</title>
</svelte:head>

<style lang="scss">
	ul {
		margin: 0;
		list-style: none;
		padding: var(--gap);

		display: grid;
		grid-template: repeat(6, minmax(1px, 1fr)) / repeat(26, minmax(1px, 1fr));
		gap: var(--gap);
		align-items: center;

		position: absolute;
		inset: 0;
		height: 100%;
		width: 100%;

		max-width: 1580px;
		margin: 0 auto;

		li {
			grid-column: span 2;
			:global(svg) {
				height: 100%;
				max-height: 130px;
			}
			&:first-child {
				// Make the first one large and featured
				align-self: start;
				padding: 2rem;
				grid-column: 1 / 15;
				grid-row: 1/-1;

				:global(.featured svg) {
					position: relative;
					z-index: 100;
					max-height: unset;
				}
			}
		}
	}

	.foreground {
		width: 100%;
		min-height: 10rem;
		position: fixed;
		bottom: 0;
		left: 0;
		overflow: hidden;
		display: flex;

		svg {
			margin-top: auto;
			display: block;
		}
	}
</style>
